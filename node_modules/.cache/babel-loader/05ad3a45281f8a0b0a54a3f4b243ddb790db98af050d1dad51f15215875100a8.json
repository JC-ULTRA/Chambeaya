{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.extendErrors = exports.resetErrorsCount = exports.reportExtraError = exports.reportError = exports.keyword$DataError = exports.keywordError = void 0;\nconst codegen_1 = require(\"./codegen\");\nconst util_1 = require(\"./util\");\nconst names_1 = require(\"./names\");\nexports.keywordError = {\n  message: ({\n    keyword\n  }) => (0, codegen_1.str)`must pass \"${keyword}\" keyword validation`\n};\nexports.keyword$DataError = {\n  message: ({\n    keyword,\n    schemaType\n  }) => schemaType ? (0, codegen_1.str)`\"${keyword}\" keyword must be ${schemaType} ($data)` : (0, codegen_1.str)`\"${keyword}\" keyword is invalid ($data)`\n};\nfunction reportError(cxt, error = exports.keywordError, errorPaths, overrideAllErrors) {\n  const {\n    it\n  } = cxt;\n  const {\n    gen,\n    compositeRule,\n    allErrors\n  } = it;\n  const errObj = errorObjectCode(cxt, error, errorPaths);\n  if (overrideAllErrors !== null && overrideAllErrors !== void 0 ? overrideAllErrors : compositeRule || allErrors) {\n    addError(gen, errObj);\n  } else {\n    returnErrors(it, (0, codegen_1._)`[${errObj}]`);\n  }\n}\nexports.reportError = reportError;\nfunction reportExtraError(cxt, error = exports.keywordError, errorPaths) {\n  const {\n    it\n  } = cxt;\n  const {\n    gen,\n    compositeRule,\n    allErrors\n  } = it;\n  const errObj = errorObjectCode(cxt, error, errorPaths);\n  addError(gen, errObj);\n  if (!(compositeRule || allErrors)) {\n    returnErrors(it, names_1.default.vErrors);\n  }\n}\nexports.reportExtraError = reportExtraError;\nfunction resetErrorsCount(gen, errsCount) {\n  gen.assign(names_1.default.errors, errsCount);\n  gen.if((0, codegen_1._)`${names_1.default.vErrors} !== null`, () => gen.if(errsCount, () => gen.assign((0, codegen_1._)`${names_1.default.vErrors}.length`, errsCount), () => gen.assign(names_1.default.vErrors, null)));\n}\nexports.resetErrorsCount = resetErrorsCount;\nfunction extendErrors({\n  gen,\n  keyword,\n  schemaValue,\n  data,\n  errsCount,\n  it\n}) {\n  /* istanbul ignore if */\n  if (errsCount === undefined) throw new Error(\"ajv implementation error\");\n  const err = gen.name(\"err\");\n  gen.forRange(\"i\", errsCount, names_1.default.errors, i => {\n    gen.const(err, (0, codegen_1._)`${names_1.default.vErrors}[${i}]`);\n    gen.if((0, codegen_1._)`${err}.instancePath === undefined`, () => gen.assign((0, codegen_1._)`${err}.instancePath`, (0, codegen_1.strConcat)(names_1.default.instancePath, it.errorPath)));\n    gen.assign((0, codegen_1._)`${err}.schemaPath`, (0, codegen_1.str)`${it.errSchemaPath}/${keyword}`);\n    if (it.opts.verbose) {\n      gen.assign((0, codegen_1._)`${err}.schema`, schemaValue);\n      gen.assign((0, codegen_1._)`${err}.data`, data);\n    }\n  });\n}\nexports.extendErrors = extendErrors;\nfunction addError(gen, errObj) {\n  const err = gen.const(\"err\", errObj);\n  gen.if((0, codegen_1._)`${names_1.default.vErrors} === null`, () => gen.assign(names_1.default.vErrors, (0, codegen_1._)`[${err}]`), (0, codegen_1._)`${names_1.default.vErrors}.push(${err})`);\n  gen.code((0, codegen_1._)`${names_1.default.errors}++`);\n}\nfunction returnErrors(it, errs) {\n  const {\n    gen,\n    validateName,\n    schemaEnv\n  } = it;\n  if (schemaEnv.$async) {\n    gen.throw((0, codegen_1._)`new ${it.ValidationError}(${errs})`);\n  } else {\n    gen.assign((0, codegen_1._)`${validateName}.errors`, errs);\n    gen.return(false);\n  }\n}\nconst E = {\n  keyword: new codegen_1.Name(\"keyword\"),\n  schemaPath: new codegen_1.Name(\"schemaPath\"),\n  params: new codegen_1.Name(\"params\"),\n  propertyName: new codegen_1.Name(\"propertyName\"),\n  message: new codegen_1.Name(\"message\"),\n  schema: new codegen_1.Name(\"schema\"),\n  parentSchema: new codegen_1.Name(\"parentSchema\")\n};\nfunction errorObjectCode(cxt, error, errorPaths) {\n  const {\n    createErrors\n  } = cxt.it;\n  if (createErrors === false) return (0, codegen_1._)`{}`;\n  return errorObject(cxt, error, errorPaths);\n}\nfunction errorObject(cxt, error, errorPaths = {}) {\n  const {\n    gen,\n    it\n  } = cxt;\n  const keyValues = [errorInstancePath(it, errorPaths), errorSchemaPath(cxt, errorPaths)];\n  extraErrorProps(cxt, error, keyValues);\n  return gen.object(...keyValues);\n}\nfunction errorInstancePath({\n  errorPath\n}, {\n  instancePath\n}) {\n  const instPath = instancePath ? (0, codegen_1.str)`${errorPath}${(0, util_1.getErrorPath)(instancePath, util_1.Type.Str)}` : errorPath;\n  return [names_1.default.instancePath, (0, codegen_1.strConcat)(names_1.default.instancePath, instPath)];\n}\nfunction errorSchemaPath({\n  keyword,\n  it: {\n    errSchemaPath\n  }\n}, {\n  schemaPath,\n  parentSchema\n}) {\n  let schPath = parentSchema ? errSchemaPath : (0, codegen_1.str)`${errSchemaPath}/${keyword}`;\n  if (schemaPath) {\n    schPath = (0, codegen_1.str)`${schPath}${(0, util_1.getErrorPath)(schemaPath, util_1.Type.Str)}`;\n  }\n  return [E.schemaPath, schPath];\n}\nfunction extraErrorProps(cxt, {\n  params,\n  message\n}, keyValues) {\n  const {\n    keyword,\n    data,\n    schemaValue,\n    it\n  } = cxt;\n  const {\n    opts,\n    propertyName,\n    topSchemaRef,\n    schemaPath\n  } = it;\n  keyValues.push([E.keyword, keyword], [E.params, typeof params == \"function\" ? params(cxt) : params || (0, codegen_1._)`{}`]);\n  if (opts.messages) {\n    keyValues.push([E.message, typeof message == \"function\" ? message(cxt) : message]);\n  }\n  if (opts.verbose) {\n    keyValues.push([E.schema, schemaValue], [E.parentSchema, (0, codegen_1._)`${topSchemaRef}${schemaPath}`], [names_1.default.data, data]);\n  }\n  if (propertyName) keyValues.push([E.propertyName, propertyName]);\n}","map":{"version":3,"names":["codegen_1","require","util_1","names_1","exports","keywordError","message","keyword","str","keyword$DataError","schemaType","reportError","cxt","error","errorPaths","overrideAllErrors","it","gen","compositeRule","allErrors","errObj","errorObjectCode","addError","returnErrors","_","reportExtraError","default","vErrors","resetErrorsCount","errsCount","assign","errors","if","extendErrors","schemaValue","data","undefined","Error","err","name","forRange","i","const","strConcat","instancePath","errorPath","errSchemaPath","opts","verbose","code","errs","validateName","schemaEnv","$async","throw","ValidationError","return","E","Name","schemaPath","params","propertyName","schema","parentSchema","createErrors","errorObject","keyValues","errorInstancePath","errorSchemaPath","extraErrorProps","object","instPath","getErrorPath","Type","Str","schPath","topSchemaRef","push","messages"],"sources":["../../lib/compile/errors.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}