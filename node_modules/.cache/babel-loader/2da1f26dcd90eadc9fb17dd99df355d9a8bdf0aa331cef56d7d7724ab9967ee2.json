{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport store from '@/store';\nimport router from '@/router';\n//import HeaderComponent from '@/components/HeaderComponent.vue'\nimport FooterComponent from '@/components/FooterComponent.vue';\nconst emaiRegex = new RegExp(/^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/);\n// nice icons from: https://www.flaticon.com/free-icons/user\nconst apiEndpoint = 'https://access.qbits.mx/api/login';\nexport default {\n  components: {\n    HeaderComponent,\n    FooterComponent\n  },\n  data: function () {\n    return {\n      fieldUser: '',\n      fieldPassword: '',\n      usrErrorMsgClass: 'error-free',\n      passErrorMsgClass: 'error-free',\n      errorText: '',\n      eye: 'open-eye',\n      credential: 'password'\n    };\n  },\n  watch: {\n    fieldUser() {\n      this.usrErrorMsgClass = \"error-free\";\n      var flagBadMail = this.fieldUser.length < 30 && !emaiRegex.test(this.fieldUser);\n      if (flagBadMail) this.usrErrorMsgClass = \"err-msg\";\n    },\n    fieldPassword() {\n      this.passErrorMsgClass = \"error-free\";\n      var flagBadMail = this.fieldPassword.length < 5;\n      if (flagBadMail) this.passErrorMsgClass = \"err-msg\";\n    }\n  },\n  computed: {\n    inhabilitado() {\n      var b = this.fieldUser.length > 0 && this.fieldPassword.length > 0 && this.usrErrorMsgClass == \"error-free\" && this.passErrorMsgClass == \"error-free\";\n      return !b;\n    }\n  },\n  methods: {\n    toogle: function () {\n      if (this.eye == 'close-eye') {\n        this.eye = 'open-eye';\n        this.credential = 'password';\n      } else {\n        this.eye = 'close-eye';\n        this.credential = 'text';\n      }\n    },\n    checkCredentials: function () {\n      axios.post(apiEndpoint, {\n        user: this.fieldUser,\n        cred: this.fieldPassword\n      }).then(response => {\n        var ud = response.data;\n        store.commit(\"setUserData\", ud);\n        const target = this.detecta(store.state.userData.role);\n        router.push(target);\n      }).catch(error => {\n        this.errorText = error.response ? error.response.data.exceptionLongDescription : error;\n        this.$refs.message01.presenta();\n      });\n    },\n    detecta: function (roles) {\n      if (store.state.destination.length > 0) {\n        var target = store.state.destination;\n        store.commit('setDestination', '');\n        return target;\n      }\n      if (typeof roles === 'string') {\n        return '/';\n      } else {\n        for (var i = 0; i < roles.length; i++) {\n          switch (roles[i].nombre) {\n            case 'admin':\n              return '/ui/admin';\n            // rol 1 = administrador\n            case 'user':\n              return '/';\n            // rol 2 = usuario comun y corriente\n            case 'normal':\n              return '/';\n            // rol 2 = usuario comun y corriente\n            default:\n              return '/';\n            // otro rol cualquiera\n          }\n        } // ends for cycle with switch inside\n      }\n    }\n  }\n};","map":{"version":3,"names":["axios","store","router","FooterComponent","emaiRegex","RegExp","apiEndpoint","components","HeaderComponent","data","fieldUser","fieldPassword","usrErrorMsgClass","passErrorMsgClass","errorText","eye","credential","watch","flagBadMail","length","test","computed","inhabilitado","b","methods","toogle","checkCredentials","post","user","cred","then","response","ud","commit","target","detecta","state","userData","role","push","catch","error","exceptionLongDescription","$refs","message01","presenta","roles","destination","i","nombre"],"sources":["/home/ubuntu/development/code/Proyecto Chambeaya/src/views/LoginView.vue"],"sourcesContent":["<template>\n    \n    <div class=\"content\">\n        <div class=\"card ancho\">\n            <div class=\"card-body text-align-left\">\n                <div class=\"row\">\n                    <div class=\"col\">\n                        <h1>Login</h1>\n                    </div>\n                </div>\n                <div class=\"row\">\n                    <div class=\"col\">\n                        <input type=\"text\" class=\"form-control icon-user\" id=\"text-usr\" v-model=\"fieldUser\" placeholder=\"william@email.com\" />\n                        <span :class=\"usrErrorMsgClass\">Formato de correo inválido</span>\n                    </div>\n                </div>\n                <div class=\"row\">\n                    <div class=\"col\">\n                        <div class=\"d-flex justify-content-between\">\n                            <input :type=\"credential\" class=\"form-control icon-key\" id=\"text-usr\" v-model=\"fieldPassword\" placeholder=\"******\" />\n                            <a :class=\"eye\" href=\"#\" @click=\"toogle\"></a>\n                        </div>\n                        <span :class=\"passErrorMsgClass\">Formato de clave inválido</span>\n                    </div>\n                </div>\n                <div class=\"row\">\n                    <div class=\"col\" style=\"text-align: right;\">\n                        <a class=\"liga\" href=\"/ui/forgot\">Forgot password ?</a>\n                    </div>\n                </div>\n                <hr/>\n                <div class=\"row\">\n                    <div class=\"col\">\n                        <div class=\"d-flex justify-content-between\">\n                            <button class=\"btn btn-success\"  :disabled=inhabilitado @click=\"checkCredentials\">Login</button>\n                            <a class=\"btn btn-warning\" href=\"/ui/register\">Register</a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    \n        <MessageComponent \n            ref=\"message01\" \n            alertType=3\n            duration=4000 \n            :text=errorText \n            iconType=1\n            style=\"max-width: 600px;\" />\n\n        <FooterComponent class=\"down\" />\n    </div>        \n    \n</template>\n\n<script>\nimport axios from 'axios'\nimport store from '@/store'\nimport router from '@/router'\n//import HeaderComponent from '@/components/HeaderComponent.vue'\nimport FooterComponent from '@/components/FooterComponent.vue'\n\nconst emaiRegex = new RegExp(/^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/);\n// nice icons from: https://www.flaticon.com/free-icons/user\nconst apiEndpoint = 'https://access.qbits.mx/api/login'\n\nexport default {\n    components: {\n\n        HeaderComponent,\n        FooterComponent,\n    },\n    data: function () {\n        return {\n            fieldUser: '',\n            fieldPassword: '',\n            usrErrorMsgClass: 'error-free',\n            passErrorMsgClass: 'error-free',\n            errorText: '',\n            eye:'open-eye',\n            credential: 'password'\n        }\n    },\n    watch: {\n        fieldUser() { \n            this.usrErrorMsgClass=\"error-free\"\n            var flagBadMail = this.fieldUser.length<30 && !emaiRegex.test(this.fieldUser)\n            if(flagBadMail) this.usrErrorMsgClass=\"err-msg\"\n        },\n        fieldPassword() {\n            this.passErrorMsgClass=\"error-free\"\n            var flagBadMail = this.fieldPassword.length<5\n            if(flagBadMail) this.passErrorMsgClass=\"err-msg\"\n        }\n    }, \n    computed : {\n        inhabilitado() {\n            var b = \n                this.fieldUser.length>0 &&\n                this.fieldPassword.length>0 &&\n                this.usrErrorMsgClass==\"error-free\" &&  \n                this.passErrorMsgClass==\"error-free\"\n            return !b\n        }\n    },    \n    methods: {\n        toogle: function() {\n            if(this.eye == 'close-eye') {\n                this.eye='open-eye'\n                this.credential='password'\n            } else {\n                this.eye = 'close-eye'\n                this.credential='text'\n            }\n        },\n        checkCredentials: function() {\n            axios.post(apiEndpoint, {\n                user: this.fieldUser,\n                cred: this.fieldPassword\n            }).then(response => {\n                var ud = response.data; \n                store.commit(\"setUserData\", ud);\n                const target = this.detecta(store.state.userData.role);                        \n                router.push(target);\n            }).catch(error => {\n                this.errorText = error.response ? error.response.data.exceptionLongDescription : error\n                this.$refs.message01.presenta()\n            })\n        },\n        detecta: function(roles) {\n            if(store.state.destination.length>0) {\n                var target = store.state.destination;\n                store.commit('setDestination','');\n                return target;\n            }\n            if (typeof roles === 'string') {\n                return '/';\n            } else {\n                for(var i=0; i<roles.length; i++) {\n                    switch(roles[i].nombre) {\n                        case 'admin': return '/ui/admin'; // rol 1 = administrador\n                        case 'user': return '/'; // rol 2 = usuario comun y corriente\n                        case 'normal': return '/'; // rol 2 = usuario comun y corriente\n                        default: return '/'; // otro rol cualquiera\n                    }\n                } // ends for cycle with switch inside\n            }\n        },\n    }\n}\n</script>\n\n<style scoped>\n.open-eye {\n    background: url(\"@/assets/eye-open.png\") no-repeat left;\n    background-size: 14px;\n    width: 20px;\n    margin-left: 8px;\n}\n.close-eye {\n    background: url(\"@/assets/eye-close.png\") no-repeat left;\n    background-size: 14px;\n    width: 20px;\n    margin-left: 8px;\n}\n.error-free {\n    color: transparent;\n}\n.err-msg {\n    color: red;\n}\n.icon-user {\n    padding-left: 30px;\n    background: url(\"@/assets/user.png\") no-repeat left;\n    background-size: 14px;\n    background-position: 2%50%;\n}\n.icon-key {\n    padding-left: 30px;\n    background: url(\"@/assets/key.png\") no-repeat left;\n    background-size: 14px;\n    background-position: 2%50%;\n}\n.ancho {\n    max-width: 380px;\n    margin: auto;\n    margin-top: 100px;\n}\n.text-align-left {\n    text-align: left;\n}\n.liga {\n    text-decoration: none;\n}\n.liga:hover {\n    text-decoration: underline;\n}\n.color1 {\n    background-color: #D8CFB5;\n}\n.color2 {\n    background-color: #CDC3A7;\n}\n.color3 {\n    background-color: #E0D8B0;\n}\n.color4 {\n    background-color: red;\n}\n.color5 {\n    background-color: #CCB9A5;\n}\n.color6 {\n    background-color: #C3B091;\n}\n.tam {\n    width: 100%;\n    height: 1200px;\n}\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}