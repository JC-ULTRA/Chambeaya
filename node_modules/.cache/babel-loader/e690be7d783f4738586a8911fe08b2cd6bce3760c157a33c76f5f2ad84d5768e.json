{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.array.push.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst _util_1 = require(\"./_util\");\nfunction getDef(opts) {\n  return {\n    keyword: \"deepProperties\",\n    type: \"object\",\n    schemaType: \"object\",\n    macro: function (schema) {\n      const allOf = [];\n      for (const pointer in schema) allOf.push(getSchema(pointer, schema[pointer]));\n      return {\n        allOf\n      };\n    },\n    metaSchema: {\n      type: \"object\",\n      propertyNames: {\n        type: \"string\",\n        format: \"json-pointer\"\n      },\n      additionalProperties: (0, _util_1.metaSchemaRef)(opts)\n    }\n  };\n}\nexports.default = getDef;\nfunction getSchema(jsonPointer, schema) {\n  const segments = jsonPointer.split(\"/\");\n  const rootSchema = {};\n  let pointerSchema = rootSchema;\n  for (let i = 1; i < segments.length; i++) {\n    let segment = segments[i];\n    const isLast = i === segments.length - 1;\n    segment = unescapeJsonPointer(segment);\n    const properties = pointerSchema.properties = {};\n    let items;\n    if (/[0-9]+/.test(segment)) {\n      let count = +segment;\n      items = pointerSchema.items = [];\n      pointerSchema.type = [\"object\", \"array\"];\n      while (count--) items.push({});\n    } else {\n      pointerSchema.type = \"object\";\n    }\n    pointerSchema = isLast ? schema : {};\n    properties[segment] = pointerSchema;\n    if (items) items.push(pointerSchema);\n  }\n  return rootSchema;\n}\nfunction unescapeJsonPointer(str) {\n  return str.replace(/~1/g, \"/\").replace(/~0/g, \"~\");\n}\nmodule.exports = getDef;","map":{"version":3,"names":["_util_1","require","getDef","opts","keyword","type","schemaType","macro","schema","allOf","pointer","push","getSchema","metaSchema","propertyNames","format","additionalProperties","metaSchemaRef","exports","default","jsonPointer","segments","split","rootSchema","pointerSchema","i","length","segment","isLast","unescapeJsonPointer","properties","items","test","count","str","replace","module"],"sources":["../../src/definitions/deepProperties.ts"],"sourcesContent":[null],"mappings":";;;;;;AAEA,MAAAA,OAAA,GAAAC,OAAA;AAEA,SAAwBC,MAAMA,CAACC,IAAwB;EACrD,OAAO;IACLC,OAAO,EAAE,gBAAgB;IACzBC,IAAI,EAAE,QAAQ;IACdC,UAAU,EAAE,QAAQ;IACpBC,KAAK,EAAE,SAAAA,CAAUC,MAAoC;MACnD,MAAMC,KAAK,GAAG,EAAE;MAChB,KAAK,MAAMC,OAAO,IAAIF,MAAM,EAAEC,KAAK,CAACE,IAAI,CAACC,SAAS,CAACF,OAAO,EAAEF,MAAM,CAACE,OAAO,CAAC,CAAC,CAAC;MAC7E,OAAO;QAACD;MAAK,CAAC;IAChB,CAAC;IACDI,UAAU,EAAE;MACVR,IAAI,EAAE,QAAQ;MACdS,aAAa,EAAE;QAACT,IAAI,EAAE,QAAQ;QAAEU,MAAM,EAAE;MAAc,CAAC;MACvDC,oBAAoB,EAAE,IAAAhB,OAAA,CAAAiB,aAAa,EAACd,IAAI;;GAE3C;AACH;AAhBAe,OAAA,CAAAC,OAAA,GAAAjB,MAAA;AAkBA,SAASU,SAASA,CAACQ,WAAmB,EAAEZ,MAAoB;EAC1D,MAAMa,QAAQ,GAAGD,WAAW,CAACE,KAAK,CAAC,GAAG,CAAC;EACvC,MAAMC,UAAU,GAAiB,EAAE;EACnC,IAAIC,aAAa,GAAiBD,UAAU;EAC5C,KAAK,IAAIE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGJ,QAAQ,CAACK,MAAM,EAAED,CAAC,EAAE,EAAE;IACxC,IAAIE,OAAO,GAAWN,QAAQ,CAACI,CAAC,CAAC;IACjC,MAAMG,MAAM,GAAGH,CAAC,KAAKJ,QAAQ,CAACK,MAAM,GAAG,CAAC;IACxCC,OAAO,GAAGE,mBAAmB,CAACF,OAAO,CAAC;IACtC,MAAMG,UAAU,GAA4BN,aAAa,CAACM,UAAU,GAAG,EAAG;IAC1E,IAAIC,KAAiC;IACrC,IAAI,QAAQ,CAACC,IAAI,CAACL,OAAO,CAAC,EAAE;MAC1B,IAAIM,KAAK,GAAG,CAACN,OAAO;MACpBI,KAAK,GAAGP,aAAa,CAACO,KAAK,GAAG,EAAE;MAChCP,aAAa,CAACnB,IAAI,GAAG,CAAC,QAAQ,EAAE,OAAO,CAAC;MACxC,OAAO4B,KAAK,EAAE,EAAEF,KAAK,CAACpB,IAAI,CAAC,EAAE,CAAC;KAC/B,MAAM;MACLa,aAAa,CAACnB,IAAI,GAAG,QAAQ;;IAE/BmB,aAAa,GAAGI,MAAM,GAAGpB,MAAM,GAAG,EAAE;IACpCsB,UAAU,CAACH,OAAO,CAAC,GAAGH,aAAa;IACnC,IAAIO,KAAK,EAAEA,KAAK,CAACpB,IAAI,CAACa,aAAa,CAAC;;EAEtC,OAAOD,UAAU;AACnB;AAEA,SAASM,mBAAmBA,CAACK,GAAW;EACtC,OAAOA,GAAG,CAACC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,CAACA,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC;AACpD;AAEAC,MAAM,CAAClB,OAAO,GAAGhB,MAAM"},"metadata":{},"sourceType":"script","externalDependencies":[]}