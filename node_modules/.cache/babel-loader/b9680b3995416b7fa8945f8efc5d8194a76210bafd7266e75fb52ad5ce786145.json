{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst codegen_1 = require(\"ajv/dist/compile/codegen\");\nconst _util_1 = require(\"./_util\");\nconst error = {\n  message: ({\n    params: {\n      schemaProp\n    }\n  }) => schemaProp ? (0, codegen_1.str)`should match case \"${schemaProp}\" schema` : (0, codegen_1.str)`should match default case schema`,\n  params: ({\n    params: {\n      schemaProp\n    }\n  }) => schemaProp ? (0, codegen_1._)`{failingCase: ${schemaProp}}` : (0, codegen_1._)`{failingDefault: true}`\n};\nfunction getDef(opts) {\n  const metaSchema = (0, _util_1.metaSchemaRef)(opts);\n  return [{\n    keyword: \"select\",\n    schemaType: [\"string\", \"number\", \"boolean\", \"null\"],\n    $data: true,\n    error,\n    dependencies: [\"selectCases\"],\n    code(cxt) {\n      const {\n        gen,\n        schemaCode,\n        parentSchema\n      } = cxt;\n      cxt.block$data(codegen_1.nil, () => {\n        const valid = gen.let(\"valid\", true);\n        const schValid = gen.name(\"_valid\");\n        const value = gen.const(\"value\", (0, codegen_1._)`${schemaCode} === null ? \"null\" : ${schemaCode}`);\n        gen.if(false); // optimizer should remove it from generated code\n        for (const schemaProp in parentSchema.selectCases) {\n          cxt.setParams({\n            schemaProp\n          });\n          gen.elseIf((0, codegen_1._)`\"\" + ${value} == ${schemaProp}`); // intentional ==, to match numbers and booleans\n          const schCxt = cxt.subschema({\n            keyword: \"selectCases\",\n            schemaProp\n          }, schValid);\n          cxt.mergeEvaluated(schCxt, codegen_1.Name);\n          gen.assign(valid, schValid);\n        }\n        gen.else();\n        if (parentSchema.selectDefault !== undefined) {\n          cxt.setParams({\n            schemaProp: undefined\n          });\n          const schCxt = cxt.subschema({\n            keyword: \"selectDefault\"\n          }, schValid);\n          cxt.mergeEvaluated(schCxt, codegen_1.Name);\n          gen.assign(valid, schValid);\n        }\n        gen.endIf();\n        cxt.pass(valid);\n      });\n    }\n  }, {\n    keyword: \"selectCases\",\n    dependencies: [\"select\"],\n    metaSchema: {\n      type: \"object\",\n      additionalProperties: metaSchema\n    }\n  }, {\n    keyword: \"selectDefault\",\n    dependencies: [\"select\", \"selectCases\"],\n    metaSchema\n  }];\n}\nexports.default = getDef;\nmodule.exports = getDef;","map":{"version":3,"names":["codegen_1","require","_util_1","error","message","params","schemaProp","str","_","getDef","opts","metaSchema","metaSchemaRef","keyword","schemaType","$data","dependencies","code","cxt","gen","schemaCode","parentSchema","block$data","nil","valid","let","schValid","name","value","const","if","selectCases","setParams","elseIf","schCxt","subschema","mergeEvaluated","Name","assign","else","selectDefault","undefined","endIf","pass","type","additionalProperties","exports","default","module"],"sources":["../../src/definitions/select.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}